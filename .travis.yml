language: go
go_import_path: github.com/whiteblock/genesis
before_install:
  - sudo apt-get install golint mockgen -y
  - mkdir -p /home/travis/gopath/src/github.com/whiteblock/genesis/net/mocks
  - go get github.com/golang/mock/mockgen
  - go get ./... || true
  - mockgen -destination=/home/travis/gopath/src/github.com/whiteblock/genesis/net/mocks/client_mock.go -package=mocks github.com/whiteblock/genesis/ssh Client,Node
sudo: false
env:
   - GOPATH=/home/travis/gopath
#  - GO111MODULE=on

os: linux
dist: xenial
sudo: required
go: 1.12.x

install: sudo apt-get install golint -y

jobs:
  include:
    - stage: Lint
      script: make lint
    - stage: Vet
      script: make vet
    - stage: Test
      script: make test
    - stage: Coverage
      script: make coverage
      after_success: bash <(curl -s https://codecov.io/bash)
